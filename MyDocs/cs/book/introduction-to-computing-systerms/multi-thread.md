优化多线程问题：

1、减少线程数

- 没必要就不创建。（资源损耗）
- 单线程多任务。（协程）

2、减少上下文切换：

- 减少锁竞争
  - CAS
  - 设计时就避免操作相同数据  



死锁解决：

- 避免一个线程同时获取多个锁
- 避免一个线程在锁内同时占用多个资源，
- 尝试使用定时锁，即超时设置。如lock.tryLock(timeout)  
- 数据库锁，加锁和解锁必须在一个数据库连接里  



建议还是使用并发容器和工具类  



底层原理：

缓存一致性  



volatile 优化

- 部分处理器追加字节