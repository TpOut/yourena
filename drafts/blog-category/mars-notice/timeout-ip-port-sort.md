默认的超时重传时间过久  

复合连接、ip 排序  



- 网络断开
- 基站忙、信号弱
- 服务器忙



根据实际调研，10s 是一个比较合适的初始值 

由于四次挥手，发起关闭请求端有一个等待操作，所以如果一下次关闭太多连接，可能会产生大量等待，影响并发性能。

  

由此考虑并发连接，但是服务端同学跳起来了  

因此综合一步，使用”复合连接“   

先设定一个较小超时时间，如4s，这样在先前请求的连接没有建立的情况下，直接新开一个请求。设定一个最多开5个的数量，类似一个连接池。  

 

那有了连接池，就有连接池内部的调度策略，即 ip 和端口号的排序算法。

IP 又有分类：  

- 自建DNS 或常规DNS IP
- 确认的动态下发或 硬代码 预备IP

然后和端口号一起随机排列，加上复合连接的策略，使用多个dns ip 和一个预备ip，  

同时按网络类型，记录ip和端口的使用情况，对其评分排序。  

对移除操作也做了冗余，防止网络短时间波动。  

最后因为服务器可能有出问题集体迁移的情况，需要对记录在一定时间内进行强制刷新。